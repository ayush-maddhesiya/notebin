import test = require("blue-tape");
import { getTestClient } from "./test";
import { B2Env } from "./env";

async function get() {
  return new B2Env(await getTestClient(), "/sdk_test");
}

test("B2Env.get", async t => {
  const env = await get();
  const values = await env.get();
  t.assert(values && typeof values == "object");
  t.assert(values.k, "v");
});

test("B2Env.put", async t => {
  const env = await get();
  let values = await env.get();
  const ts = Date.now().toString();
  values.ts = ts;
  await env.set(values);
  values = await env.get();
  t.assert(values.ts, ts);
});
